{
  "version": "1.0.0",
  "mappings": [
    {
      "contractId": "BHV-SESSION-TITLE-LIFECYCLE",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/runtime-loop.browser.ts::refreshSessionTitleAuto + extension/src/panel/App.vue::handleRefreshSession"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/business/chat/session-title.feature"
        },
        {
          "layer": "e2e",
          "target": "bdd/evidence/brain-e2e.latest.json::session 标题生命周期：自动生成 + 菜单重刷 + 列表重命名 + 自动阈值"
        }
      ]
    },
    {
      "contractId": "BHV-CHAT-MAX-STEPS-CONFIG",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/runtime-loop.browser.ts::runAgentLoop + extension/src/panel/stores/runtime.ts::saveConfig"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/business/chat/max-steps-config.feature"
        }
      ]
    },
    {
      "contractId": "BHV-CHAT-NO-TAB-START",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/runtime-router.ts::handleBrainRun + extension/src/sw/kernel/runtime-loop.browser.ts::runAgentLoop + extension/src/sw/kernel/session-manager.browser.ts::appendMessage"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/business/chat/no-tab-start.feature"
        }
      ]
    },
    {
      "contractId": "BHV-TAB-REF-DEFAULT",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/runtime-loop.browser.ts::queryAllTabsForRuntime + getActiveTabIdForRuntime + executeToolCall"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/business/chat/tab-ref-default.feature"
        }
      ]
    },
    {
      "contractId": "BHV-CHAT-HISTORY-INCLUDES-TOOL-RESULT",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/runtime-loop.browser.ts::buildLlmMessagesFromContext + runAgentLoop + executeToolCall"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/technical/chat/history-includes-tool-result.feature"
        },
        {
          "layer": "e2e",
          "target": "bdd/evidence/brain-e2e.latest.json::brain.runtime :: 同一会话第二轮继续执行不应触发 LLM HTTP 400"
        }
      ]
    },
    {
      "contractId": "BHV-CHAT-LIST-OPEN-TABS-TOOLS",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/runtime-loop.browser.ts::summarizeToolTarget + executeToolCall + safeStringify"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/technical/chat/list-open-tabs-tools.feature"
        },
        {
          "layer": "e2e",
          "target": "bdd/evidence/brain-e2e.latest.json::brain.runtime :: brain.run.start 支持 tool_calls 闭环并写入 step stream||brain.runtime :: brain.debug.dump 可观测 llm 原始调用与工具步骤"
        }
      ]
    },
    {
      "contractId": "BHV-CDP-ON-DEMAND",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/runtime-loop.browser.ts::executeStep + executeToolCall + runAgentLoop"
        },
        {
          "layer": "integration",
          "target": "extension/src/sw/kernel/runtime-infra.browser.ts::handleMessage(cdp.observe|snapshot|action|execute|verify|detach)"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/technical/cdp/on-demand.feature"
        },
        {
          "layer": "e2e",
          "target": "bdd/evidence/brain-e2e.latest.json::brain.run.start 支持 tool_calls 闭环并写入 step stream||LLM 工具超时后可按失败信号调整 timeout 重试成功||CDP 失败后不中断，LLM 可继续推进并完成||LLM HTTP 失败时应产生 auto_retry 事件并失败收口"
        }
      ]
    },
    {
      "contractId": "BHV-PANEL-ACTION-OPEN",
      "proofs": [
        {
          "layer": "integration",
          "target": "extension/src/background/sw-main.ts::chrome.action.onClicked + chrome.sidePanel.open"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/business/panel/action-open.feature"
        }
      ]
    },
    {
      "contractId": "BHV-CHAT-TOOL-RENDERER-REGISTRY",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/panel/stores/runtime.ts::loadConversation + extension/src/panel/App.vue::message bubble rendering"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/business/chat/tool-renderer-registry.feature"
        }
      ]
    },
    {
      "contractId": "BHV-CHAT-STREAMING-MESSAGE-CONTAINER",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/orchestrator.browser.ts::persistEvent + extension/src/debug/App.vue::Live Events + Step Stream rendering"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/business/chat/streaming-message-container.feature"
        }
      ]
    },
    {
      "contractId": "BHV-LLM-CAPABILITY-GATE",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/runtime-loop.browser.ts::requestLlmWithRetry + runAgentLoop + executeToolCall"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/technical/chat/llm-capability-gate.feature"
        },
        {
          "layer": "e2e",
          "target": "bdd/evidence/brain-e2e.latest.json::brain.runtime :: brain.run.start 支持 tool_calls 闭环并写入 step stream||brain.runtime :: LLM 工具超时后可按失败信号调整 timeout 重试成功||brain.runtime :: CDP 失败后不中断，LLM 可继续推进并完成||brain.runtime :: LLM HTTP 失败时应产生 auto_retry 事件并失败收口"
        }
      ]
    },
    {
      "contractId": "BHV-LLM-PROVIDER-ADAPTER-ROUTING",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/__tests__/llm-provider-registry.browser.test.ts::registers and resolves providers by id + extension/src/sw/kernel/__tests__/llm-profile-resolver.browser.test.ts::returns profile_not_found when llmProfiles is missing + extension/src/sw/kernel/__tests__/runtime-router.browser.test.ts::使用 profile 配置时应发出 llm.route.selected 并命中 provider/model + profile 指向未注册 provider 时应 llm.route.blocked 并 failed_execute"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/technical/chat/llm-provider-adapter-routing.feature"
        }
      ]
    },
    {
      "contractId": "BHV-LLM-PROFILE-ESCALATION",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/llm-profile-policy.ts::decideProfileEscalation + extension/src/sw/kernel/__tests__/llm-profile-policy.browser.test.ts::escalates to next profile when repeated failure happens||blocks escalation when current profile is already highest + extension/src/sw/kernel/__tests__/runtime-router.browser.test.ts::LLM 重复失败后应升级 profile 并发出 llm.route.escalated"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/technical/chat/llm-profile-escalation.feature"
        }
      ]
    },
    {
      "contractId": "BHV-SUBAGENT-RUN-MODES",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/runtime-router.ts::handleBrainAgentRun + extension/src/sw/kernel/__tests__/runtime-router.browser.test.ts::supports brain.agent.run single and binds role/profile into route selection + supports brain.agent.run parallel with per-task role/profile routing + supports brain.agent.run chain and returns fan-in summary with {previous} injection + brain.agent.run chain rejects autoRun=false + brain.agent.run parallel rejects oversized task list"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/technical/chat/subagent-run-modes.feature"
        }
      ]
    },
    {
      "contractId": "BHV-LLM-LIVE-CAPABILITY",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/runtime-loop.browser.ts::requestLlmWithRetry + runAgentLoop + executeToolCall"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/technical/chat/llm-live-capability.feature"
        },
        {
          "layer": "e2e",
          "target": "bdd/evidence/brain-e2e-live.latest.json::sidepanel llm-live :: 真实 LLM 在浏览器目标上达到可验证成功率"
        }
      ]
    },
    {
      "contractId": "BHV-SESSION-METADATA-SPLIT-STORAGE",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/session-store.browser.ts::appendEntryChunk + readEntryChunks + appendTraceChunk"
        },
        {
          "layer": "integration",
          "target": "extension/src/sw/kernel/session-manager.browser.ts::appendEntry + extension/src/sw/kernel/runtime-router.ts::buildConversationView + extension/src/sw/kernel/orchestrator.browser.ts::getStepStream"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/technical/storage/session-metadata-split-storage.feature"
        }
      ]
    },
    {
      "contractId": "BHV-SESSION-COMPACTION-STATE-MACHINE",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/__tests__/orchestrator.browser.test.ts::retryable 错误先触发 auto_retry_start||overflow 不走 retry，走 compaction"
        },
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/__tests__/compaction.browser.test.ts::overflow 时必须触发 compaction||split-turn 会把 cut 对齐到用户消息||prepareCompaction 返回 kept/dropped 和 draft"
        },
        {
          "layer": "integration",
          "target": "extension/src/sw/kernel/orchestrator.browser.ts::preSendCompactionCheck + handleAgentEnd + runCompaction + persistEvent"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/technical/session/compaction-state-machine.feature"
        }
      ]
    },
    {
      "contractId": "BHV-SESSION-INTERRUPTION-RECOVERY",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/__tests__/orchestrator.browser.test.ts::重启后保留会话与 trace，但运行态不会自动恢复"
        },
        {
          "layer": "integration",
          "target": "extension/src/sw/kernel/__tests__/runtime-router.browser.test.ts::service worker 重启后可恢复会话并继续同一 session 对话 + extension/src/sw/kernel/__tests__/runtime-router-interruption.browser.test.ts::user stop should not be treated as implicit interruption recovery"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/technical/session/interruption-recovery.feature"
        }
      ]
    },
    {
      "contractId": "BHV-AGENT-HOOK-LIFECYCLE",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/__tests__/orchestrator.browser.test.ts::tool.before_call block + tool.after_result patch + compaction.check + agent_end.after"
        },
        {
          "layer": "integration",
          "target": "extension/src/sw/kernel/orchestrator.browser.ts::runHook + executeStep + preSendCompactionCheck + handleAgentEnd + runCompaction"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/technical/session/agent-hook-lifecycle.feature"
        }
      ]
    },
    {
      "contractId": "BHV-CAPABILITY-PROVIDER-ROUTING",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/__tests__/orchestrator.browser.test.ts::script provider 成功时保持 modeUsed=script 且无 mode 切换||script provider 失败时保持错误语义且不发生 mode 切换||script provider 失败且无 cdp provider 时仍保持 script 错误语义||cdp 失败时直接返回失败"
        },
        {
          "layer": "integration",
          "target": "extension/src/sw/kernel/orchestrator.browser.ts::registerToolProvider + invokeProviderWithHooks + executeStep"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/technical/session/capability-provider-routing.feature"
        }
      ]
    },
    {
      "contractId": "BHV-SESSION-LIST-TITLE-DELETE",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/runtime-router.ts::deriveSessionTitle + handleSession(brain.session.title.refresh|brain.session.delete)"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/business/session/list-title-delete.feature"
        },
        {
          "layer": "e2e",
          "target": "bdd/evidence/brain-e2e.latest.json::brain.session :: session 标题生命周期：自动生成 + 菜单重刷 + 列表重命名 + 自动阈值"
        }
      ]
    },
    {
      "contractId": "BHV-SESSION-STORAGE-RESET-BOOTSTRAP",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/storage-reset.browser.ts::resetSessionStore + initSessionIndex"
        },
        {
          "layer": "integration",
          "target": "extension/src/background/sw-main.ts::bootstrapSessionStore + initSessionIndex"
        },
        {
          "layer": "integration",
          "target": "extension/src/sw/kernel/runtime-router.ts::handleStorage(brain.storage.reset|brain.storage.init)"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/technical/storage/session-reset-bootstrap.feature"
        }
      ]
    },
    {
      "contractId": "BHV-CHAT-MESSAGE-ACTIONS-RETRY-COPY",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/panel/utils/message-actions.ts::canForkMessage+canRetryMessage + extension/src/panel/App.vue::handleEditMessage + extension/src/panel/components/ChatMessage.vue::user/assistant action rendering + extension/src/panel/stores/runtime.ts::forkFromAssistantEntry+retryLastAssistantEntry + extension/src/sw/kernel/runtime-router.ts::handleSession(brain.session.fork)+handleBrainRun(brain.run.regenerate)"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/business/chat/message-actions-retry-copy.feature"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/business/chat/regenerate-answer.feature"
        },
        {
          "layer": "e2e",
          "target": "bdd/evidence/brain-e2e.latest.json::panel.vnext :: sidepanel 渲染并支持复制/历史分叉/最后一条重试||panel.vnext :: user inline 编辑：最后一条重跑，历史消息分叉重跑"
        }
      ]
    },
    {
      "contractId": "BHV-CHAT-SHARED-TABS-CONTEXT",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/panel/stores/runtime.ts::sendPrompt + extension/src/sw/kernel/runtime-loop.browser.ts::startFromPrompt + buildLlmMessagesFromContext"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/business/chat/shared-tabs-context.feature"
        },
        {
          "layer": "e2e",
          "target": "bdd/evidence/brain-e2e.latest.json::brain.run.start 注入 shared tabs 上下文并每次覆盖"
        }
      ]
    },
    {
      "contractId": "BHV-CDP-STRICT-VERIFY-ENFORCEMENT",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/runtime-loop.browser.ts::shouldVerifyStep + executeToolCall + runAgentLoop"
        },
        {
          "layer": "integration",
          "target": "extension/src/sw/kernel/runtime-infra.browser.ts::verifyByCDP + handleMessage(cdp.action|cdp.verify)"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/technical/cdp/strict-verify-enforcement.feature"
        },
        {
          "layer": "e2e",
          "target": "bdd/evidence/brain-e2e.latest.json::brain.reliability :: strict verify 失败不应 done（failed_verify 收口）"
        }
      ]
    },
    {
      "contractId": "BHV-CDP-TAB-SNAPSHOT-BINDING",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/runtime-infra.browser.ts::takeSnapshot + resolveRefEntry + executeRefActionByCDP"
        },
        {
          "layer": "integration",
          "target": "extension/src/sw/kernel/__tests__/runtime-infra.browser.test.ts::supports cdp.observe/snapshot/action/verify with lease guard"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/technical/cdp/tab-snapshot-binding.feature"
        },
        {
          "layer": "e2e",
          "target": "bdd/evidence/brain-e2e.latest.json::brain.reliability :: tab/snapshot 绑定：过期 ref 不可静默成功"
        }
      ]
    },
    {
      "contractId": "BHV-CHAT-DONE-SEMANTICS-STRICT",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/runtime-loop.browser.ts::executeToolCall + runAgentLoop"
        },
        {
          "layer": "integration",
          "target": "extension/src/sw/kernel/runtime-router.ts::handleBrainRun + brain.run.stop"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/technical/chat/done-semantics-strict.feature"
        },
        {
          "layer": "e2e",
          "target": "bdd/evidence/brain-e2e.latest.json::brain.reliability :: done 语义严格：verify 失败不可 done"
        }
      ]
    },
    {
      "contractId": "BHV-CHAT-AUTO-REPAIR-BOUNDARY",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/runtime-loop.browser.ts::requestLlmWithRetry + runAgentLoop"
        },
        {
          "layer": "integration",
          "target": "extension/src/sw/kernel/events.ts::auto_retry_start + auto_retry_end + loop_skip_stopped"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/technical/chat/auto-repair-boundary.feature"
        },
        {
          "layer": "e2e",
          "target": "bdd/evidence/brain-e2e.latest.json::brain.reliability :: auto-repair 边界：execute_error 可重试，max_steps/stopped 不续跑"
        }
      ]
    },
    {
      "contractId": "BHV-CHAT-NO-PROGRESS-GUARD",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/__tests__/runtime-router.browser.test.ts::strict verify 不可判定时应以 max_steps 收口（不做 no_progress 早停） + 重复同签名 tool_calls 时不再触发 loop_no_progress，改为 max_steps 收口 + PI 对齐后不再发 loop_no_progress 事件，重复调用由 max_steps 收口"
        },
        {
          "layer": "integration",
          "target": "extension/src/sw/kernel/runtime-router.ts::handleBrainRun + extension/src/sw/kernel/runtime-loop.browser.ts::runAgentLoop"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/technical/chat/no-progress-guard.feature"
        },
        {
          "layer": "e2e",
          "target": "bdd/evidence/brain-e2e.latest.json::brain.reliability :: PI 对齐：重复失败不触发 no-progress 守卫，按 max_steps 收口"
        }
      ]
    },
    {
      "contractId": "BHV-CHAT-TAB-STICKY-RUN-SCOPE",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/runtime-loop.browser.ts::applySharedTabs + executeToolCall + runAgentLoop"
        },
        {
          "layer": "integration",
          "target": "extension/src/sw/kernel/runtime-router.ts::handleBrainRun + tabIds payload normalization"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/technical/chat/tab-sticky-run-scope.feature"
        },
        {
          "layer": "e2e",
          "target": "bdd/evidence/brain-e2e.latest.json::brain.reliability :: tab sticky：active tab 漂移后仍命中 primaryTab"
        }
      ]
    },
    {
      "contractId": "BHV-CHAT-MARKDOWN-LINKS",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/panel/components/ChatMessage.vue::IncremarkContent + IncremarkLink"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/business/chat/markdown-links.feature"
        }
      ]
    },
    {
      "contractId": "BHV-CDP-LIVE-STRICT-VERIFY-ENFORCEMENT",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/runtime-loop.browser.ts::shouldVerifyStep + executeToolCall + runAgentLoop"
        },
        {
          "layer": "integration",
          "target": "extension/src/sw/kernel/runtime-infra.browser.ts::verifyByCDP + handleMessage(cdp.action|cdp.verify)"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/technical/cdp/strict-verify-enforcement-live.feature"
        },
        {
          "layer": "e2e",
          "target": "bdd/evidence/brain-e2e-live.latest.json::brain.reliability :: strict verify 失败不应 done（failed_verify 收口）"
        }
      ]
    },
    {
      "contractId": "BHV-CDP-LIVE-TAB-SNAPSHOT-BINDING",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/runtime-infra.browser.ts::takeSnapshot + resolveRefEntry + executeRefActionByCDP"
        },
        {
          "layer": "integration",
          "target": "extension/src/sw/kernel/__tests__/runtime-infra.browser.test.ts::supports cdp.observe/snapshot/action/verify with lease guard"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/technical/cdp/tab-snapshot-binding-live.feature"
        },
        {
          "layer": "e2e",
          "target": "bdd/evidence/brain-e2e-live.latest.json::brain.reliability :: tab/snapshot 绑定：过期 ref 不可静默成功"
        }
      ]
    },
    {
      "contractId": "BHV-CHAT-LIVE-DONE-SEMANTICS-STRICT",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/runtime-loop.browser.ts::executeToolCall + runAgentLoop"
        },
        {
          "layer": "integration",
          "target": "extension/src/sw/kernel/runtime-router.ts::handleBrainRun + brain.run.stop"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/technical/chat/done-semantics-strict-live.feature"
        },
        {
          "layer": "e2e",
          "target": "bdd/evidence/brain-e2e-live.latest.json::brain.reliability :: done 语义严格：verify 失败不可 done"
        }
      ]
    },
    {
      "contractId": "BHV-CHAT-LIVE-AUTO-REPAIR-BOUNDARY",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/runtime-loop.browser.ts::requestLlmWithRetry + runAgentLoop"
        },
        {
          "layer": "integration",
          "target": "extension/src/sw/kernel/events.ts::auto_retry_start + auto_retry_end + loop_skip_stopped"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/technical/chat/auto-repair-boundary-live.feature"
        },
        {
          "layer": "e2e",
          "target": "bdd/evidence/brain-e2e-live.latest.json::brain.reliability :: auto-repair 边界：execute_error 可重试，max_steps/stopped 不续跑"
        }
      ]
    },
    {
      "contractId": "BHV-CHAT-LIVE-NO-PROGRESS-GUARD",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/__tests__/runtime-router.browser.test.ts::strict verify 不可判定时应以 max_steps 收口（不做 no_progress 早停） + 重复同签名 tool_calls 时不再触发 loop_no_progress，改为 max_steps 收口 + PI 对齐后不再发 loop_no_progress 事件，重复调用由 max_steps 收口"
        },
        {
          "layer": "integration",
          "target": "extension/src/sw/kernel/runtime-router.ts::handleBrainRun + extension/src/sw/kernel/runtime-loop.browser.ts::runAgentLoop"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/technical/chat/no-progress-guard-live.feature"
        },
        {
          "layer": "e2e",
          "target": "bdd/evidence/brain-e2e-live.latest.json::brain.runtime :: PI 对齐：重复可恢复工具失败不熔断，按 max_steps 收口"
        }
      ]
    },
    {
      "contractId": "BHV-CHAT-LIVE-TAB-STICKY-RUN-SCOPE",
      "proofs": [
        {
          "layer": "unit",
          "target": "extension/src/sw/kernel/runtime-loop.browser.ts::applySharedTabs + executeToolCall + runAgentLoop"
        },
        {
          "layer": "integration",
          "target": "extension/src/sw/kernel/runtime-router.ts::handleBrainRun + tabIds payload normalization"
        },
        {
          "layer": "browser-cdp",
          "target": "bdd/features/technical/chat/tab-sticky-run-scope-live.feature"
        },
        {
          "layer": "e2e",
          "target": "bdd/evidence/brain-e2e-live.latest.json::brain.reliability :: tab sticky：active tab 漂移后仍命中 primaryTab"
        }
      ]
    }
  ]
}
