{
  "id": "BHV-CHAT-MAX-STEPS-CONFIG",
  "intent": "Max Steps 必须可配置并被运行时严格执行，在超过阈值时稳定收口为 max_steps 状态",
  "context": {
    "surface": "sidepanel.settings + runtime.loop",
    "configKey": "maxSteps",
    "defaultValue": 100
  },
  "steps": [
    "configure_max_steps_in_ui",
    "save_and_reload_config",
    "trigger_multi_step_loop",
    "observe_loop_termination_on_max_steps"
  ],
  "observables": [
    "config_persisted_in_storage",
    "runtime_loop_reads_dynamic_limit",
    "final_status_is_max_steps_when_limit_reached"
  ],
  "risk": "medium",
  "allowed_side_effects": [
    "config_write(maxSteps)",
    "runtime_status_transition(max_steps)",
    "assistant_status_message(max_steps)"
  ],
  "proof_requirements": {
    "required_layers": ["unit", "browser-cdp"],
    "min_layers": 2
  },
  "degrade_policy": {
    "on_invalid_config": [
      "fallback_to_default_100",
      "continue_loop_without_crash"
    ],
    "on_save_failure": [
      "preserve_previous_valid_config",
      "return_user_visible_error"
    ]
  },
  "rollback_or_compensation": [
    "fallback_to_default_100_if_config_invalid"
  ],
  "version": "1.1.0"
}
